<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TradeBotPro ‚Äì Setup Wizard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="TradeBotPro setup wizard for new trade accounts." />

  <style>
    :root {
      --primary-blue: #1f4e79;f
      --accent-blue: #00a3ff;
      --dark-text: #151820;
      --muted-text: #6b7280;
      --light-bg: #f3f4f9;
      --white: #ffffff;
      --border-subtle: rgba(15, 23, 42, 0.12);
      --chip-bg: #eef2ff;
      --chip-border: rgba(37, 99, 235, 0.3);
      --chip-bg-muted: #f3f4f6;
      --chip-border-muted: rgba(148, 163, 184, 0.6);
      --success-green: #0f7b46;
      --error-red: #b3261e;
    }

    * { box-sizing: border-box; }
    html { scroll-behavior: smooth; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      background: radial-gradient(circle at top left, #e0ebff 0, #f3f4f9 40%, #fdfdfd 100%);
      color: var(--dark-text);
      line-height: 1.5;
    }

    a { color: inherit; text-decoration: none; }

    .page {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      border-bottom: 1px solid rgba(15, 23, 42, 0.06);
      background: rgba(248, 250, 252, 0.96);
      backdrop-filter: blur(6px);
      position: sticky;
      top: 0;
      z-index: 20;
    }

    .header-inner {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0.6rem 1.25rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.75rem;
    }

    .logo-wrap {
      display: flex;
      align-items: center;
      gap: 0.6rem;
    }

    .logo-icon {
      width: 30px;
      height: 30px;
      border-radius: 9px;
      background: var(--primary-blue);
      position: relative;
    }

    .logo-icon::before,
    .logo-icon::after {
      content: "";
      position: absolute;
      background: var(--white);
      border-radius: 4px;
    }

    .logo-icon::before { width: 11px; height: 17px; left: 7px; top: 6px; }
    .logo-icon::after  { width: 6px; height: 11px; right: 7px; top: 9px; }

    .logo-main { font-weight: 700; font-size: 1rem; color: var(--primary-blue); }
    .logo-tag  { font-size: 0.75rem; color: var(--muted-text); }

    .header-note { font-size: 0.75rem; color: var(--muted-text); }
    .header-note strong { color: var(--primary-blue); font-weight: 600; }

    main {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2.5rem 1.25rem 3rem;
    }

    .wizard-shell {
      width: 100%;
      max-width: 1100px;
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1.4fr);
      gap: 1.75rem;
      align-items: flex-start;
    }

    .wizard-left {
      padding: 1.5rem 1.6rem;
      border-radius: 1.2rem;
      background: rgba(255, 255, 255, 0.92);
      box-shadow: 0 24px 60px rgba(15, 23, 42, 0.15), 0 0 0 1px rgba(15, 23, 42, 0.03);
    }

    .wizard-right {
      padding: 1.5rem 1.6rem;
      border-radius: 1.2rem;
      background: rgba(248, 250, 252, 0.96);
      border: 1px solid rgba(148, 163, 184, 0.35);
      backdrop-filter: blur(4px);
    }

    /* PROGRESS BAR */
    .wizard-progress-wrap { margin-bottom: 1.4rem; }

    .progress-label-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.75rem;
      margin-bottom: 0.35rem;
      font-size: 0.75rem;
      color: var(--muted-text);
    }
    .progress-label-row span strong { color: var(--primary-blue); }

    .progress-bar-outer {
      position: relative;
      height: 6px;
      border-radius: 999px;
      background: rgba(148, 163, 184, 0.3);
      overflow: hidden;
    }
    .progress-bar-inner {
      position: absolute;
      left: 0; top: 0; bottom: 0;
      width: 0%;
      background: linear-gradient(90deg, var(--primary-blue), var(--accent-blue));
      border-radius: inherit;
      transition: width 0.25s ease;
    }

    .step-dots {
      margin-top: 0.35rem;
      display: flex;
      justify-content: space-between;
      gap: 0.5rem;
      font-size: 0.7rem;
      color: var(--muted-text);
    }

    .step-dot {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      white-space: nowrap;
    }

    .step-dot-circle {
      width: 14px;
      height: 14px;
      border-radius: 999px;
      border: 2px solid rgba(148, 163, 184, 0.7);
      background: var(--white);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 0.6rem;
      color: rgba(148, 163, 184, 0.8);
    }

    .step-dot.is-active .step-dot-circle {
      border-color: var(--primary-blue);
      color: var(--primary-blue);
      background: #e0ecff;
    }

    .step-dot.is-complete .step-dot-circle {
      border-color: var(--success-green);
      background: #dcfce7;
      color: var(--success-green);
    }

    .wizard-title-kicker {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--accent-blue);
      margin-bottom: 0.35rem;
    }

    .wizard-title { margin: 0 0 0.4rem; font-size: 1.6rem; color: var(--primary-blue); }

    .wizard-subtitle {
      margin: 0 0 0.85rem;
      font-size: 0.92rem;
      color: var(--muted-text);
    }

    .wizard-benefits {
      margin: 0 0 1rem;
      padding: 0;
      list-style: none;
      font-size: 0.86rem;
      color: var(--dark-text);
    }
    .wizard-benefits li { display: flex; gap: 0.4rem; margin-bottom: 0.35rem; }
    .wizard-benefits li span:first-child { font-size: 0.9rem; }

    .wizard-note {
      margin-top: 0.9rem;
      font-size: 0.8rem;
      color: var(--muted-text);
      border-radius: 0.7rem;
      padding: 0.7rem 0.8rem;
      background: #f1f5f9;
    }
    .wizard-note strong { color: var(--primary-blue); font-weight: 600; }
    .wizard-note ul { margin: 0.6rem 0 0; padding-left: 1.1rem; }

    /* RIGHT HEADER */
    .wizard-right-header { margin-bottom: 1rem; }

    .wizard-step-label {
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--accent-blue);
      margin-bottom: 0.25rem;
    }

    .wizard-step-title { margin: 0 0 0.25rem; font-size: 1.2rem; color: var(--primary-blue); }
    .wizard-step-subtitle { margin: 0; font-size: 0.88rem; color: var(--muted-text); }

    .step-panel { display: none; margin-top: 0.9rem; }
    .step-panel.is-active { display: block; }

    .field-group { margin-bottom: 1rem; }

    .field-label-row {
      display: flex;
      justify-content: space-between;
      gap: 0.5rem;
      margin-bottom: 0.25rem;
    }

    label { font-size: 0.8rem; font-weight: 500; color: var(--dark-text); }
    .field-hint { font-size: 0.75rem; color: var(--muted-text); }

    input[type="text"],
    input[type="tel"],
    input[type="email"],
    textarea,
    select {
      width: 100%;
      padding: 0.6rem 0.7rem;
      border-radius: 0.55rem;
      border: 1px solid var(--border-subtle);
      font: inherit;
      font-size: 0.9rem;
      background: var(--white);
    }

    textarea { min-height: 80px; resize: vertical; }

    input:focus, textarea:focus, select:focus {
      outline: 0;
      border-color: rgba(37, 99, 235, 0.7);
      box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.4);
    }

    /* CHIPS (single source of truth: .is-selected) */
    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 0.25rem;
      margin-bottom: 14px;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.4rem 0.9rem;
      border-radius: 999px;
      border: 1px solid rgba(0, 0, 0, 0.12);
      background: #ffffff;
      font-size: 0.85rem;
      line-height: 1.2;
      cursor: pointer;
      user-select: none;
      white-space: nowrap;
      transition: background 0.15s ease, border-color 0.15s ease, color 0.15s ease, box-shadow 0.15s ease;
    }

    .chip:hover {
      border-color: #1f4e79;
      background: rgba(31, 78, 121, 0.06);
    }

    .chip.is-selected {
      outline: 2px solid rgba(31, 78, 121, 0.45);
      background: rgba(31, 78, 121, 0.08);
      border-color: #1f4e79;
      color: #1f4e79;
      font-weight: 600;
    }

    /* FOOTER ACTIONS */
   .wizard-footer{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:14px;
  margin-top:18px;
  padding-top:14px;
  border-top:1px solid rgba(0,0,0,0.08);
}

.wizard-footer-left{
  display:flex;
  align-items:center;
  gap:10px;
  min-width:140px;
}

.wizard-step-label{
  font-size:13px;
  opacity:0.8;
  font-weight:600;
}

.wizard-footer-right{
  display:flex;
  align-items:center;
  justify-content:flex-end;
  gap:10px;
  flex-wrap:wrap;
}

.wizard-footer-right .btn{
  white-space:nowrap;
}


    .btn {
      border-radius: 999px;
      border: 1px solid transparent;
      padding: 0.55rem 1.1rem;
      font-size: 0.86rem;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      background: transparent;
    }

    .btn:focus-visible {
      outline: 2px solid var(--accent-blue);
      outline-offset: 2px;
    }

    .btn-secondary {
      border-color: var(--border-subtle);
      background: #f9fafb;
      color: var(--dark-text);
    }
    .btn-secondary:hover { background: #e5e7eb; }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary-blue), #163857);
      color: var(--white);
      border-color: transparent;
      box-shadow: 0 12px 28px rgba(15, 23, 42, 0.35);
    }
    .btn-primary:hover { filter: brightness(1.03); box-shadow: 0 16px 34px rgba(15, 23, 42, 0.4); }
    .btn-primary:disabled { opacity: 0.6; cursor: default; box-shadow: none; }

    .btn-ghost { border-color: transparent; background: transparent; color: var(--muted-text); }
    .btn-ghost:hover { color: var(--primary-blue); }

    .wizard-status-message {
      margin-top: 0.7rem;
      font-size: 0.8rem;
      min-height: 1.2em;
    }
    .wizard-status-message--success { color: var(--success-green); }
    .wizard-status-message--error   { color: var(--error-red); }

    .summary-box {
      margin-top: 0.9rem;
      padding: 0.8rem 0.9rem;
      border-radius: 0.7rem;
      background: #ecfdf5;
      border: 1px solid rgba(22, 163, 74, 0.45);
      font-size: 0.8rem;
      color: #14532d;
    }
    .summary-box strong { font-weight: 600; }

    @media (max-width: 900px) {
      main { padding-top: 1.5rem; }
      .wizard-shell { grid-template-columns: minmax(0, 1fr); }
      .wizard-left { order: -1; }
    }
    @media (max-width: 600px) {
      .header-inner { flex-direction: column; align-items: flex-start; }
      .wizard-left, .wizard-right { padding: 1.1rem 1.1rem; }
      .step-dots { font-size: 0.65rem; }
    }
  </style>
</head>

<body>
<nav class="tbp-nav">
  <a href="./index.html">Home</a>
  <a href="./signup.html">Sign up</a>
  <a href="./login.html">Admin login</a>
</nav>

<style>
  .tbp-nav {
    display: flex;
    gap: 14px;
    padding: 10px 16px;
    font-size: 14px;
  }
  .tbp-nav a {
    text-decoration: none;
    font-weight: 600;
  }
</style>


<style>
  .tbp-nav {
    display: flex;
    gap: 14px;
    padding: 10px 16px;
    font-size: 14px;
  }
  .tbp-nav a {
    text-decoration: none;
    font-weight: 600;
  }
  <style>
  /* --- Chip layout + selection --- */
  .chip-row{
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    align-items:center;
  }

  .chip{
    appearance:none;
    border:1px solid rgba(15,23,42,0.14);
    background:#fff;
    border-radius:999px;
    padding:10px 14px;
    cursor:pointer;
    user-select:none;
    font:inherit;
    line-height:1;
    display:inline-flex;
    align-items:center;
    gap:8px;
    transition:transform .05s ease, border-color .15s ease, background-color .15s ease;
  }

  .chip:active{ transform:translateY(1px); }

  .chip.is-selected{
    border-color: rgba(31,78,121,0.55);
    background: rgba(31,78,121,0.08);
    box-shadow: 0 0 0 2px rgba(31,78,121,0.12) inset;
  }

  /* IMPORTANT: allow clicking the text span */
  .chip span{ pointer-events:none; }

  /* --- Step panels stay clean --- */
  .step-panel{ display:none; }
  .step-panel.is-active{ display:block; }

  /* --- Footer alignment (buttons right, consistent spacing) --- */
  .wizard-footer-right{
    display:flex;
    justify-content:flex-end;
    align-items:center;
    gap:12px;
    flex-wrap:wrap;
  }

  .wizard-footer-right .btn{
    min-width:140px;
  }
</style>

</style>

<div class="page">
  <!-- HEADER -->
  <header>
    <div class="header-inner">
      <div class="logo-wrap">
        <div class="logo-icon" aria-hidden="true"></div>
        <div>
          <div class="logo-main">TradeBotPro</div>
          <div class="logo-tag">More jobs. Less admin. Powered by AI.</div>
        </div>
      </div>
      <div class="header-note">
        Goal: make you <strong>wish you had signed up years ago</strong> in the first month.
      </div>
    </div>
  </header>

  <!-- MAIN -->
  <main>
    <div class="wizard-shell">

      <!-- LEFT PANEL -->
      <aside class="wizard-left">
        <div class="wizard-progress-wrap">
          <div class="progress-label-row">
            <span><strong>Setup progress</strong></span>
            <span id="progress-percent">Step 1 of 4</span>
          </div>
          <div class="progress-bar-outer">
            <div id="progress-bar-inner" class="progress-bar-inner"></div>
          </div>
          <div class="step-dots">
            <div class="step-dot is-active" data-step-dot="1">
              <div class="step-dot-circle">1</div>
              <div class="step-dot-label">Business basics</div>
            </div>
            <div class="step-dot" data-step-dot="2">
              <div class="step-dot-circle">2</div>
              <div class="step-dot-label">Area &amp; pricing</div>
            </div>
            <div class="step-dot" data-step-dot="3">
              <div class="step-dot-circle">3</div>
              <div class="step-dot-label">Messaging &amp; reviews</div>
            </div>
            <div class="step-dot" data-step-dot="4">
              <div class="step-dot-circle">4</div>
              <div class="step-dot-label">Demo &amp; go-live</div>
            </div>
          </div>
        </div>

        <div class="wizard-title-kicker">Setup wizard</div>
        <h1 class="wizard-title">Let‚Äôs tune TradeBotPro to your business</h1>
        <p class="wizard-subtitle">
          This takes around 5‚Äì10 minutes. Your answers help us configure how TradeBotPro
          talks to customers, where it books jobs and which enquiries it chases hardest.
        </p>

        <ul class="wizard-benefits">
          <li><span>‚ö°</span><span><strong>Instant replies</strong> that feel like a real member of your team.</span></li>
          <li><span>üìç</span><span><strong>Postcode-based coverage</strong> so you only quote in the areas you want.</span></li>
          <li><span>‚≠ê</span><span><strong>Review follow-ups</strong> tuned to your preferred platform.</span></li>
          <li><span>üìÖ</span><span><strong>Calendar-ready</strong> so confirmed jobs can drop straight into your diary.</span></li>
        </ul>

        <div class="wizard-note">
          <strong>Important:</strong> This page is your setup wizard only ‚Äì nothing goes live
          to customers until you give the go-ahead. You‚Äôll get a full demo evening to test
          everything from your own phones first.
        </div>

        <div class="wizard-note">
          <strong>What happens next?</strong><br />
          Once this wizard is complete, we‚Äôll plug in your WhatsApp, build your first flows
          and set up your calendar links behind the scenes.
          <br /><br />
          During your demo evening:
          <ul>
            <li>You‚Äôll message yourself from a partner‚Äôs phone.</li>
            <li>TradeBotPro will reply like a real customer conversation.</li>
            <li>You‚Äôll even be able to book a test job into your diary.</li>
          </ul>
          <strong>Free trial offer:</strong><br />
          We can offer a short free trial after the demo for anyone who isn‚Äôt fully convinced
          yet ‚Äî your setup stays in place so it‚Äôs easy to switch on.
        </div>
      </aside>

      <!-- RIGHT PANEL -->
      <section class="wizard-right" aria-live="polite">
        <div class="wizard-right-header">
          <div id="wizard-step-label" class="wizard-step-label">Step 1</div>
          <h2 id="wizard-step-title" class="wizard-step-title">Business basics</h2>
          <p id="wizard-step-subtitle" class="wizard-step-subtitle">
            Who are you, what do you do and how do you like to run things?
          </p>
        </div>

        <!-- ===================== -->
<!-- STEP 1 -->
<!-- ===================== -->
<div class="step-panel is-active wizard-step" data-step="1">

  <div class="field-group">
    <div class="field-label-row">
      <label for="contact_name">Main contact name</label>
      <span class="field-hint">Who TradeBotPro should refer to by name.</span>
    </div>
    <input id="contact_name" name="contact_name" type="text" autocomplete="name" />
  </div>

  <div class="field-group">
    <div class="field-label-row">
      <label for="business_name">Business name</label>
      <span class="field-hint">Exactly as you want it shown to customers.</span>
    </div>
    <input id="business_name" name="business_name" type="text" />
  </div>

  <!-- Main trade -->
<div class="field-group">
  <div class="field-label-row">
    <label>What trade are you?</label>
    <span class="field-hint">Pick the closest match ‚Äì we‚Äôll fine-tune later.</span>
  </div>

  <input type="hidden" id="main_trade" name="main_trade">

  <div class="chip-row" data-field="main_trade" data-select="single">
    <button type="button" class="chip"><span>Plumbing &amp; heating</span></button>
    <button type="button" class="chip"><span>Heating only</span></button>
    <button type="button" class="chip"><span>Gas engineer</span></button>
    <button type="button" class="chip"><span>Electrician</span></button>
    <button type="button" class="chip"><span>Roofing &amp; guttering</span></button>
    <button type="button" class="chip"><span>Landscaping / gardening</span></button>
    <button type="button" class="chip"><span>Window cleaning</span></button>
    <button type="button" class="chip"><span>Cleaning / carpet cleaning</span></button>
    <button type="button" class="chip"><span>Builder</span></button>
    <button type="button" class="chip"><span>Handyman</span></button>
    <button type="button" class="chip"><span>Pest control</span></button>
    <button type="button" class="chip"><span>Home repairs &amp; maintenance</span></button>
    <button type="button" class="chip"><span>Other</span></button>
  </div>
</div>


<!-- Business stage -->
<div class="field-group">
  <div class="field-label-row">
    <label>Where are you as a business?</label>
    <span class="field-hint">This just helps us set expectations on go-live.</span>
  </div>

  <input type="hidden" id="business_stage" name="business_stage">

  <div class="chip-row" data-field="business_stage" data-select="single">
    <button type="button" class="chip"><span>Already trading</span></button>
    <button type="button" class="chip"><span>Launching in next 3 months</span></button>
    <button type="button" class="chip"><span>Just exploring options</span></button>
  </div>
</div>


  <div class="field-group">
    <div class="field-label-row">
      <label for="contact_email">Best email for setup &amp; reports</label>
    </div>
    <input id="contact_email" name="email" type="email" />
  </div>

  <div class="field-group">
    <div class="field-label-row">
      <label for="contact_mobile">Mobile / WhatsApp number</label>
    </div>
    <input id="contact_mobile" name="phone" type="tel" />
  </div>
</div>

<!-- ===================== -->
<!-- STEP 2 -->
<!-- ===================== -->
<div class="step-panel wizard-step" data-step="2">

  <div class="field-group">
    <label for="base_postcode">Base postcode</label>
    <input id="base_postcode" name="base_postcode" type="text" />
  </div>

 <input type="hidden" id="coverage_radius" name="coverage_radius">

<div class="chip-row" data-field="coverage_radius" data-select="single">
  <button type="button" class="chip"><span>Just my town / city</span></button>
  <button type="button" class="chip"><span>Up to ~10 miles from base</span></button>
  <button type="button" class="chip"><span>Up to ~20 miles from base</span></button>
  <button type="button" class="chip"><span>City-wide / multiple postcodes</span></button>
  <button type="button" class="chip"><span>Custom list (we‚Äôll import later)</span></button>
</div>


callout_style

  <input type="hidden" id="preferred_jobs" name="preferred_jobs" />
  <div class="field-group">
    <label>Which jobs do you want more of?</label>
    <div class="chip-row" data-field="preferred_jobs" data-select="multi">
      <button type="button" class="chip"><span>Emergency jobs</span></button>
      <button type="button" class="chip"><span>Small jobs</span></button>
      <button type="button" class="chip"><span>Bigger installs</span></button>
      <button type="button" class="chip"><span>Maintenance</span></button>
      <button type="button" class="chip"><span>Repeat clients</span></button>
    </div>
  </div>
</div>

<!-- ===================== -->
<!-- STEP 3 -->
<!-- ===================== -->
<div class="step-panel wizard-step" data-step="3">

  <input type="hidden" id="tone_of_voice" name="tone_of_voice" />
  <div class="field-group">
    <label>How should TradeBotPro sound?</label>
    <div class="chip-row" data-field="tone_of_voice" data-select="single">
      <button type="button" class="chip"><span>Friendly & informal</span></button>
      <button type="button" class="chip"><span>Professional</span></button>
      <button type="button" class="chip"><span>Premium</span></button>
      <button type="button" class="chip"><span>Short & efficient</span></button>
      <button type="button" class="chip"><span>Decide together</span></button>
    </div>
  </div>

<input type="hidden" id="channels" name="channels">

<div class="chip-row" data-field="channels" data-select="multi">
  <button type="button" class="chip"><span>WhatsApp</span></button>
  <button type="button" class="chip"><span>SMS / text messages</span></button>
  <button type="button" class="chip"><span>Facebook Messenger</span></button>
  <button type="button" class="chip"><span>Website chat widget</span></button>
  <button type="button" class="chip"><span>Instagram DMs</span></button>
</div>


<!-- ===================== -->
<!-- STEP 4 -->
<!-- ===================== -->
<div class="step-panel wizard-step" data-step="4">

 <input type="hidden" id="demo_style" name="demo_style">

<div class="chip-row" data-field="demo_style" data-select="multi">
  <button type="button" class="chip"><span>Test from our own phones first</span></button>
  <button type="button" class="chip"><span>Test with a few real customers</span></button>
  <button type="button" class="chip"><span>Test calendar bookings</span></button>
  <button type="button" class="chip"><span>Test review follow-up flow</span></button>
</div>

  <textarea id="extra_notes" name="extra_notes" placeholder="Anything else we should know?"></textarea>
</div>


          <div class="summary-box" id="summary-box" hidden>
            <strong>Nice work ‚Äì that‚Äôs your wizard complete.</strong><br />
            Your answers have been saved to your TradeBotPro profile. We‚Äôll confirm
            your demo evening and go-live plan with you before anything switches on.
          </div>
        </div>

        <!-- FOOTER ACTIONS -->
        <div class="wizard-footer">
          <div class="wizard-footer-left">
            <span id="wizard-footer-text">
              Step <strong>1</strong> of <strong>4</strong>.
            </span>
          </div>

         <div class="wizard-footer">
  <div class="wizard-footer-left">
    <span id="wizard-step-label" class="wizard-step-label">Step 1 of 4</span>
  </div>

  <div class="wizard-footer-right">
    <button type="button" class="btn btn-secondary" id="btn-back" disabled>‚Üê Back</button>
    <button type="button" class="btn btn-secondary" id="btn-save-draft">Save draft</button>

    <button type="button" class="btn btn-primary" id="btn-next">Next step ‚Üí</button>

    <!-- last step only -->
    <button type="button" class="btn btn-primary" id="btn-finish" style="display:none">
      Finish setup ‚Üí
    </button>

    <!-- shows only after Finish succeeds (keep your existing logic if you already use it) -->
    <button type="button" class="btn btn-primary" id="btn-dashboard" style="display:none">
      Back to dashboard ‚Üí
    </button>
  </div>
</div>

        <div id="wizard-status-message" class="wizard-status-message"></div>
      </section>
    </div>
  </main>
</div>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TradeBotPro ‚Äî Setup Wizard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root{
      --primary-blue:#1f4e79;
      --accent-blue:#00a3ff;
      --dark-text:#151820;
      --muted-text:#6b7280;
      --light-bg:#f3f4f9;
      --white:#ffffff;
      --border-subtle:rgba(15,23,42,0.12);
      --success-green:#0f7b46;
      --error-red:#b3261e;
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
      background:radial-gradient(circle at top left,#e0ebff 0,#f3f4f9 45%,#f3f4f9 100%);
      color:var(--dark-text);
    }

    .wrap{max-width:980px;margin:0 auto;padding:24px 16px 40px}
    .card{
      background:var(--white);
      border:1px solid var(--border-subtle);
      border-radius:18px;
      box-shadow:0 10px 30px rgba(15,23,42,0.08);
      overflow:hidden;
    }

    .header{
      padding:18px 18px 14px;
      border-bottom:1px solid var(--border-subtle);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
    }
    .header h1{
      margin:0;
      font-size:18px;
      font-weight:800;
      letter-spacing:-0.01em;
      color:var(--primary-blue);
    }
    .header .sub{
      margin-top:4px;
      font-size:13px;
      color:var(--muted-text);
    }

    #wizardStatus{
      font-size:13px;
      font-weight:600;
      color:var(--muted-text);
      text-align:right;
      min-height:18px;
      margin-top:2px;
    }

    .content{padding:18px}
    .step-panel{display:none}
    .step-panel.is-active{display:block}

    .field-group{margin:14px 0 16px}
    .field-label-row{
      display:flex;
      align-items:baseline;
      justify-content:space-between;
      gap:12px;
      margin-bottom:8px;
    }
    label{font-weight:800;font-size:13px}
    .field-hint{color:var(--muted-text);font-size:12px}

    input[type="text"], input[type="email"], input[type="tel"], textarea, select{
      width:100%;
      padding:12px 12px;
      border-radius:12px;
      border:1px solid var(--border-subtle);
      outline:none;
      font-size:14px;
      background:#fff;
    }
    textarea{min-height:100px;resize:vertical}

    .chip-row{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:6px;
    }
    .chip{
      border:1px solid var(--border-subtle);
      background:#fff;
      border-radius:999px;
      padding:10px 12px;
      font-size:13px;
      cursor:pointer;
      user-select:none;
      display:inline-flex;
      align-items:center;
      gap:8px;
      transition:transform .05s ease, border-color .15s ease, background .15s ease;
    }
    .chip:hover{transform:translateY(-1px);border-color:rgba(31,78,121,0.35)}
    .chip.is-selected{
      border-color:rgba(0,163,255,0.7);
      background:rgba(0,163,255,0.10);
      box-shadow:0 6px 18px rgba(0,163,255,0.12);
    }
    .chip span{pointer-events:none}

    .wizard-footer{
      border-top:1px solid var(--border-subtle);
      padding:14px 18px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      background:rgba(245,247,250,0.6);
    }
    .wizard-footer-left{
      font-size:12px;
      color:var(--muted-text);
      display:flex;
      align-items:center;
      gap:10px;
      min-height:18px;
    }
    #wizard-step-label{font-weight:800;color:var(--primary-blue)}

    .wizard-footer-right{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:flex-end;
      flex-wrap:wrap;
    }

    .btn{
      border:1px solid transparent;
      border-radius:12px;
      padding:10px 14px;
      font-weight:800;
      cursor:pointer;
      font-size:13px;
      min-width:140px;
      transition:transform .05s ease, opacity .15s ease;
    }
    .btn:active{transform:translateY(1px)}
    .btn[disabled]{opacity:.55;cursor:not-allowed}
    .btn-primary{background:var(--primary-blue);color:#fff}
    .btn-secondary{background:#fff;color:var(--primary-blue);border-color:rgba(31,78,121,0.25)}
    .btn-ghost{background:#fff;color:var(--dark-text);border-color:var(--border-subtle)}
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <div class="header">
        <div>
          <h1>TradeBotPro Setup Wizard</h1>
          <div class="sub">Complete this once ‚Äî we‚Äôll build your WhatsApp + flows behind the scenes.</div>
        </div>
        <div id="wizardStatus"></div>
      </div>

      <div class="content">
        <!-- IMPORTANT: hidden inputs for chip rows (so chips always have somewhere to write the value) -->
        <input type="hidden" id="main_trade" name="main_trade" />
        <input type="hidden" id="business_stage" name="business_stage" />
        <input type="hidden" id="coverage_radius" name="coverage_radius" />
        <input type="hidden" id="callout_style" name="callout_style" />
        <input type="hidden" id="callout_band" name="callout_band" />
        <input type="hidden" id="preferred_jobs" name="preferred_jobs" />
        <input type="hidden" id="tone_of_voice" name="tone_of_voice" />
        <input type="hidden" id="channels" name="channels" />
        <input type="hidden" id="review_platforms" name="review_platforms" />
        <input type="hidden" id="review_push_level" name="review_push_level" />
        <input type="hidden" id="demo_style" name="demo_style" />
      <input type="hidden" id="demo_slot" name="demo_slot">

<div class="chip-row" data-field="demo_slot" data-select="single">
  <button type="button" class="chip"><span>Weekday ‚Äì 6‚Äì8pm</span></button>
  <button type="button" class="chip"><span>Weekday ‚Äì 8‚Äì10pm</span></button>
  <button type="button" class="chip"><span>Weekend evening</span></button>
  <button type="button" class="chip"><span>Daytime (I‚Äôm flexible)</span></button>
</div>

            <input id="contact_name" name="contact_name" type="text" autocomplete="name" />
          </div>

          <div class="field-group">
            <div class="field-label-row">
              <label for="business_name">Business name</label>
              <span class="field-hint">Exactly as you want it shown to customers.</span>
            </div>
            <input id="business_name" name="business_name" type="text" placeholder="Business name" />
          </div>

          <div class="field-group">
            <div class="field-label-row">
              <label>What trade are you?</label>
              <span class="field-hint">Pick the closest match ‚Äì we‚Äôll fine-tune later.</span>
            </div>

            <div class="chip-row" data-field="main_trade" data-select="single">
              <button type="button" class="chip"><span>Plumbing &amp; heating</span></button>
              <button type="button" class="chip"><span>Heating only</span></button>
              <button type="button" class="chip"><span>Gas engineer</span></button>
              <button type="button" class="chip"><span>Electrician</span></button>
              <button type="button" class="chip"><span>Roofing &amp; guttering</span></button>
              <button type="button" class="chip"><span>Landscaping / gardening</span></button>
              <button type="button" class="chip"><span>Window cleaning</span></button>
              <button type="button" class="chip"><span>Cleaning / carpet cleaning</span></button>
              <button type="button" class="chip"><span>Builder</span></button>
              <button type="button" class="chip"><span>Handyman</span></button>
              <button type="button" class="chip"><span>Pest control</span></button>
              <button type="button" class="chip"><span>Home repairs &amp; maintenance</span></button>
              <button type="button" class="chip"><span>Other</span></button>
            </div>
          </div>

          <div class="field-group">
            <div class="field-label-row">
              <label>Where are you as a business?</label>
              <span class="field-hint">This just helps us set expectations on go-live.</span>
            </div>
            <div class="chip-row" data-field="business_stage" data-select="single">
              <button type="button" class="chip"><span>Already trading</span></button>
              <button type="button" class="chip"><span>Launching in next 3 months</span></button>
              <button type="button" class="chip"><span>Just exploring options</span></button>
            </div>
          </div>

          <div class="field-group">
            <div class="field-label-row">
              <label for="contact_email">Best email for setup &amp; reports</label>
              <span class="field-hint">We‚Äôll send onboarding details and monthly stats here.</span>
            </div>
            <input id="contact_email" name="email" type="email" autocomplete="email" />
          </div>

          <div class="field-group">
            <div class="field-label-row">
              <label for="contact_mobile">Mobile / WhatsApp number</label>
              <span class="field-hint">The main number customers currently use.</span>
            </div>
            <input id="contact_mobile" name="phone" type="tel" autocomplete="tel" />
          </div>
        </div>

        <!-- Step 2 -->
        <div class="step-panel" data-step="2">
          <div class="field-group">
            <div class="field-label-row">
              <label for="base_postcode">Base postcode</label>
              <span class="field-hint">We always work from postcode, not town.</span>
            </div>
            <input id="base_postcode" name="base_postcode" type="text" />
          </div>

          <div class="field-group">
            <div class="field-label-row">
              <label>Where do you want TradeBotPro to quote?</label>
              <span class="field-hint">We‚Äôll filter enquiries outside your preferred area.</span>
            </div>
            <div class="chip-row" data-field="coverage_radius" data-select="single">
              <button type="button" class="chip"><span>Just my town / city</span></button>
              <button type="button" class="chip"><span>Up to ~10 miles from base</span></button>
              <button type="button" class="chip"><span>Up to ~20 miles from base</span></button>
              <button type="button" class="chip"><span>City-wide / multiple postcodes</span></button>
              <button type="button" class="chip"><span>Custom list (we‚Äôll import later)</span></button>
            </div>
          </div>

          <div class="field-group">
            <div class="field-label-row">
              <label>How do you usually charge call-outs?</label>
              <span class="field-hint">Helps the AI give sensible ballpark prices.</span>
            </div>
            <div class="chip-row" data-field="callout_style" data-select="single">
              <button type="button" class="chip"><span>Free estimates (no call-out fee)</span></button>
              <button type="button" class="chip"><span>Paid call-out, deducted from job</span></button>
              <button type="button" class="chip"><span>Fixed call-out fee</span></button>
              <button type="button" class="chip"><span>No emergency call-outs</span></button>
            </div>
          </div>

          <div class="field-group">
            <div class="field-label-row">
              <label>Typical call-out fee band</label>
              <span class="field-hint">We can refine by job type later.</span>
            </div>
            <input type="hidden" id="callout_band" name="callout_band">

<div class="chip-row" data-field="callout_band" data-select="single">
  <button type="button" class="chip"><span>Up to ¬£79</span></button>
  <button type="button" class="chip"><span>¬£80‚Äì¬£119</span></button>
  <button type="button" class="chip"><span>¬£120‚Äì¬£179</span></button>
  <button type="button" class="chip"><span>¬£180+</span></button>
  <button type="button" class="chip"><span>Varies ‚Äì discuss with us</span></button>
</div>


          <div class="field-group">
            <div class="field-label-row">
              <label>Which jobs do you want more of?</label>
              <span class="field-hint">TradeBotPro can prioritise the work you enjoy.</span>
            </div>
           <input type="hidden" id="preferred_jobs" name="preferred_jobs">

<div class="chip-row" data-field="preferred_jobs" data-select="multi">
  <button type="button" class="chip"><span>Emergency / urgent jobs</span></button>
  <button type="button" class="chip"><span>Small jobs / quick wins</span></button>
  <button type="button" class="chip"><span>Bigger projects / installs</span></button>
  <button type="button" class="chip"><span>Maintenance / servicing</span></button>
  <button type="button" class="chip"><span>Landlords / repeat clients</span></button>
</div>


        <!-- Step 3 -->
        <div class="step-panel" data-step="3">
          <div class="field-group">
            <div class="field-label-row">
              <label>How should TradeBotPro sound?</label>
              <span class="field-hint">We‚Äôll match your tone of voice.</span>
            </div>
            <input type="hidden" id="tone_of_voice" name="tone_of_voice">

<div class="chip-row" data-field="tone_of_voice" data-select="single">
  <button type="button" class="chip"><span>Friendly &amp; informal</span></button>
  <button type="button" class="chip"><span>Professional &amp; straight to the point</span></button>
  <button type="button" class="chip"><span>Premium / high-end feel</span></button>
  <button type="button" class="chip"><span>Very short &amp; efficient</span></button>
  <button type="button" class="chip"><span>We‚Äôll decide together</span></button>
</div>


          <div class="field-group">
            <div class="field-label-row">
              <label>Which channels should we start with?</label>
              <span class="field-hint">You can add more later.</span>
            </div>
            <div class="chip-row" data-field="channels" data-select="multi">
              <button type="button" class="chip"><span>WhatsApp</span></button>
              <button type="button" class="chip"><span>SMS / text messages</span></button>
              <button type="button" class="chip"><span>Facebook Messenger</span></button>
              <button type="button" class="chip"><span>Website chat widget</span></button>
              <button type="button" class="chip"><span>Instagram DMs</span></button>
            </div>
          </div>

          <div class="field-group">
            <div class="field-label-row">
              <label>Which review platform do you use or want to use?</label>
              <span class="field-hint">We‚Äôll send customers there automatically after jobs.</span>
            </div>
           <input type="hidden" id="review_platforms" name="review_platforms">

<div class="chip-row" data-field="review_platforms" data-select="multi">
  <button type="button" class="chip"><span>Google Reviews</span></button>
  <button type="button" class="chip"><span>Trustpilot</span></button>
  <button type="button" class="chip"><span>Facebook page reviews</span></button>
  <button type="button" class="chip"><span>Yell / similar directories</span></button>
  <button type="button" class="chip"><span>Checkatrade / trade portals</span></button>
</div>


          <div class="field-group">
            <div class="field-label-row">
              <label for="review_link">Paste your main review link (optional)</label>
              <span class="field-hint">We‚Äôll wire this into your follow-up messages.</span>
            </div>
            <input id="review_link" name="review_link" type="text" />
          </div>

          <div class="field-group">
            <div class="field-label-row">
              <label>How hard should we push for reviews?</label>
              <span class="field-hint">You stay in control ‚Äì no over-the-top nagging.</span>
            </div>
            <div class="chip-row" data-field="review_push_level" data-select="single">
              <button type="button" class="chip"><span>Very gentle reminder only</span></button>
              <button type="button" class="chip"><span>Standard follow-up &amp; one reminder</span></button>
              <button type="button" class="chip"><span>Quite proactive (several reminders)</span></button>
            </div>
          </div>

          <div class="field-group">
            <div class="field-label-row">
              <label for="ai_avoid">Anything you never want the AI to say?</label>
              <span class="field-hint">Phrases, promises or situations to avoid.</span>
            </div>
            <textarea id="ai_avoid" name="ai_avoid"></textarea>
          </div>
        </div>

        <!-- Step 4 -->
        <div class="step-panel" data-step="4">
          <div class="field-group">
            <div class="field-label-row">
              <label>How would you like to run your demo?</label>
              <span class="field-hint">We‚Äôll set up a ‚Äútest evening‚Äù for you and your partner/team.</span>
            </div>
            <div class="chip-row" data-field="demo_style" data-select="multi">
              <button type="button" class="chip"><span>Test from our own phones first</span></button>
              <button type="button" class="chip"><span>Test with a few real customers</span></button>
              <button type="button" class="chip"><span>Test calendar bookings</span></button>
              <button type="button" class="chip"><span>Test review follow-up flow</span></button>
            </div>
          </div>

          <div class="field-group">
            <div class="field-label-row">
              <label>Preferred evening to test from your own phones</label>
              <span class="field-hint">So you can send messages from one phone to the other and see it in action.</span>
            </div>
            <div class="chip-row" data-field="demo_slot" data-select="single">
              <button type="button" class="chip"><span>Weekday ‚Äì 6‚Äì8pm</span></button>
              <button type="button" class="chip"><span>Weekday ‚Äì 8‚Äì10pm</span></button>
              <button type="button" class="chip"><span>Weekend evening</span></button>
              <button type="button" class="chip"><span>Daytime (I‚Äôm flexible)</span></button>
            </div>
          </div>

          <div class="field-group">
            <div class="field-label-row">
              <label>Roughly when do you want to go fully live?</label>
              <span class="field-hint">Purely for planning ‚Äì nothing switches on without your say-so.</span>
            </div>
            <div class="chip-row" data-field="golive_timing" data-select="single">
              <button type="button" class="chip"><span>Within 1 week of the demo</span></button>
              <button type="button" class="chip"><span>Within 1 month</span></button>
              <button type="button" class="chip"><span>Later ‚Äì just getting ready</span></button>
            </div>
          </div>

          <div class="field-group">
  <div class="field-label-row">
    <label>Roughly when do you want to go fully live?</label>
    <span class="field-hint">Purely for planning ‚Äì nothing switches on without your say-so.</span>
  </div>

  <!-- ONE hidden input only -->
  <input type="hidden" id="golive_timing" name="golive_timing">

  <div class="chip-row" data-field="golive_timing" data-select="single">
    <button type="button" class="chip"><span>Within 1 week of the demo</span></button>
    <button type="button" class="chip"><span>Within 1 month</span></button>
    <button type="button" class="chip"><span>Later ‚Äì just getting ready</span></button>
  </div>
</div>


      <div class="wizard-footer">
        <div class="wizard-footer-left">
          <span id="wizard-step-label">Step 1 of 4</span>
          <span style="opacity:.55;">‚Ä¢</span>
          <span>Save anytime ‚Äî finish on step 4.</span>
        </div>

        <div class="wizard-footer-right">
          <button type="button" class="btn btn-ghost" id="btn-save-draft">Save draft</button>
          <button type="button" class="btn btn-secondary" id="btn-back" disabled>‚Üê Back</button>
          <button type="button" class="btn btn-primary" id="btn-next">Next step ‚Üí</button>
          <button type="button" class="btn btn-primary" id="btn-finish" style="display:none">Finish setup ‚Üí</button>
          <button type="button" class="btn btn-primary" id="btn-dashboard" style="display:none">Back to dashboard ‚Üí</button>
        </div>
      </div>
    </div>
  </div>

<style>
  /* Phase 1: keep steps clean + footer aligned */
  .step-panel { display:none; }
  .step-panel.is-active { display:block; }

  .wizard-footer-right{
    display:flex;
    justify-content:flex-end;
    align-items:center;
    gap:12px;
    flex-wrap:wrap;
  }

  /* optional: make buttons consistent */
  .wizard-footer-right .btn{
    min-width:140px;
  }
</style>

<script type="module">
  import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

 const SUPABASE_URL = "https://yaiutswdcbfwkxfqxkzy.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlhaXV0c3dkY2Jmd2t4ZnF4a3p5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ1MDE2MDgsImV4cCI6MjA4MDA3NzYwOH0.HOLFxzjsZ5Ieqg0b-aTdP0hAdLsPVXL6Zjs-HgOHgc8";
  const sb = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  const qs = new URLSearchParams(location.search);
  const customer_id = (qs.get("customer_id") || qs.get("customerId") || "").trim();
  const setup_token = (qs.get("setup_token") || qs.get("setupToken") || "").trim();

  const $ = (id) => document.getElementById(id);

  function setStatus(msg, ok=true){
    const el = $("status-msg") || $("saveStatus") || $("wizardStatus");
    if(!el) return;
    el.textContent = msg || "";
    el.style.color = ok ? "#0f7b46" : "#b3261e";
  }

  function showFatal(msg){
    alert(msg);
    setStatus(msg, false);
  }

  // ---------- Step navigation (Phase 1) ----------
  function wireWizardNav(){
    const btnNext = $("btn-next");
    const btnBack = $("btn-back");
    const btnSaveDraft = $("btn-save-draft"); // Phase 1: doesn‚Äôt save, just avoids breaking
    const btnDashboard = $("btn-dashboard");  // Phase 1: hidden, no redirect

    const steps = Array.from(document.querySelectorAll(".step-panel[data-step]"))
      .sort((a,b)=> (parseInt(a.dataset.step,10)||0) - (parseInt(b.dataset.step,10)||0));

    if(!steps.length){
      console.warn("[TBP] No .step-panel[data-step] found");
      return;
    }

    const maxStep = parseInt(steps[steps.length-1].dataset.step, 10) || steps.length;

    function getActiveStep(){
      const active = steps.find(s => s.classList.contains("is-active"));
      if(active) return parseInt(active.dataset.step,10) || 1;
      return 1;
    }

    function showStep(n){
      steps.forEach(s=>{
        const sn = parseInt(s.dataset.step,10) || 0;
        const on = sn === n;
        s.classList.toggle("is-active", on);
      });

      if(btnBack) btnBack.disabled = (n <= 1);

      // Phase 1: Next works through all steps, no Finish behaviour
      if(btnNext) btnNext.style.display = (n < maxStep) ? "" : "none";
      if(btnDashboard) btnDashboard.style.display = (n === maxStep) ? "" : "none"; // optional ‚Äúend‚Äù button

      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    // init
    showStep(getActiveStep());

    if(btnNext){
      btnNext.addEventListener("click", ()=>{
        const cur = getActiveStep();
        if(cur < maxStep) showStep(cur + 1);
      });
    }

    if(btnBack){
      btnBack.addEventListener("click", ()=>{
        const cur = getActiveStep();
        if(cur > 1) showStep(cur - 1);
      });
    }

    if(btnSaveDraft){
      btnSaveDraft.addEventListener("click", ()=>{
        // Phase 1: no saving yet ‚Äî keep button harmless
        setStatus("Draft saving is disabled in Phase 1 (navigation + load only).", false);
      });
    }

    if(btnDashboard){
      btnDashboard.addEventListener("click", ()=>{
        // Phase 1: no dashboard yet
        setStatus("Dashboard redirect is disabled in Phase 1.", false);
      });
    }
  }

  // ---------- Load wizard (Phase 1) ----------
  async function loadWizard(){
    try{
      setStatus("Loading‚Ä¶", true);

      if(!customer_id || !setup_token){
        showFatal("Missing customer_id or setup_token. Please restart from the signup form.");
        location.assign("index.html#signup");
        return;
      }

      const { data, error } = await sb.rpc("tbp_customer_load", {
        p_customer_id: customer_id,
        p_setup_token: setup_token
      });

      if(error) throw error;

      const row = Array.isArray(data) ? data[0] : data;
      if(!row?.id){
        showFatal("Wizard link invalid or expired. Please re-submit the signup form to generate a fresh setup link.");
        return;
      }

      // Prefill only the basics for Phase 1
      if ($("business_name")) $("business_name").value = row.business_name || "";
      if ($("contact_name")) $("contact_name").value = row.contact_name || "";
      if ($("contact_email")) $("contact_email").value = row.email || "";
      if ($("contact_mobile")) $("contact_mobile").value = row.phone || "";

      setStatus("", true);
    }catch(err){
      console.error("[TBP] loadWizard error:", err);
      showFatal(err?.message || "Failed to load wizard.");
    }
  }

  // ---------- Init (ONE place only) ----------
  window.addEventListener("DOMContentLoaded", async () => {
    wireWizardNav();
    await loadWizard();
  });
</script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll(".chip-row").forEach(row => {
    const field = row.dataset.field;
    const mode  = row.dataset.select || "single";
    const input = document.getElementById(field);
    if(!field || !input) return;

    row.addEventListener("click", (e) => {
      const chip = e.target.closest("button.chip");
      if(!chip) return;

      if(mode === "multi"){
        chip.classList.toggle("is-selected");
        input.value = Array.from(row.querySelectorAll(".chip.is-selected"))
          .map(c => c.innerText.trim()).join(", ");
      } else {
        row.querySelectorAll(".chip").forEach(c => c.classList.remove("is-selected"));
        chip.classList.add("is-selected");
        input.value = chip.innerText.trim();
      }
    });
  });
});
</script>


</body>
</html>

