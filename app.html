<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TradeBotPro – Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --primary: #1f4e79;
      --bg: #f5f7fa;
      --card: #ffffff;
      --text: #1b1b1f;
      --muted: #6b7280;
      --border: #dde3ec;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
    }
    .layout { display: flex; min-height: 100vh; }
    .sidebar {
      width: 250px; background: var(--primary); color: white;
      padding: 20px; display: flex; flex-direction: column;
    }
    .logo { font-size: 20px; font-weight: bold; margin-bottom: 20px; }
    .nav a {
      display: block; padding: 10px; color: white; text-decoration: none;
      border-radius: 8px; margin-bottom: 6px;
    }
    .nav a.active, .nav a:hover { background: rgba(255,255,255,0.15); }
    .sidebar-footer { margin-top: auto; font-size: 12px; opacity: .8; }
    .main {
      flex: 1; padding: 24px; max-width: 1100px; margin: auto;
    }
    h1 { margin-top: 0; }
    .cards {
      display: grid; grid-template-columns: repeat(auto-fit,minmax(320px,1fr));
      gap: 16px;
    }
    .card {
      background: var(--card); border-radius: 14px; padding: 16px;
      border: 1px solid var(--border);
    }
    label { display: block; margin-top: 10px; font-weight: 600; font-size: 14px; }
    input, select, textarea {
      width: 100%; padding: 8px; margin-top: 4px; border-radius: 8px;
      border: 1px solid var(--border); font-size: 14px;
    }
    textarea { min-height: 70px; }
    .btn {
      margin-top: 14px; padding: 10px; border-radius: 999px;
      border: none; background: var(--primary); color: white;
      cursor: pointer;
    }
    .muted { font-size: 12px; color: var(--muted); }
  </style>
</head>

<body>
<div class="layout">

  <aside class="sidebar">
    <div class="logo">TradeBotPro</div>
    <div class="nav">
      <a class="active">Dashboard</a>
      <a>Conversations</a>
      <a>Billing</a>
    </div>
    <div class="sidebar-footer">Dashboard V1</div>
  </aside>

  <main class="main">
    <h1>Business Dashboard</h1>

    <div class="cards">

      <!-- BUSINESS -->
      <div class="card">
        <h2>Business details</h2>
        <label>Business name</label>
        <input id="business_name" />

        <label>Main trade</label>
        <select id="trade_type">
          <option value="plumbing_heating">Plumbers & Heating Engineers</option>
          <option value="electrical">Electricians</option>
          <option value="roofing_guttering">Roofers & Guttering</option>
          <option value="builders_handymen">Builders & Handymen</option>
          <option value="general_builder">General Builder</option>
          <option value="home_repairs">Home Repairs & Maintenance</option>
          <option value="painting_decorating">Painters & Decorators</option>
          <option value="landscaping_gardening">Landscapers & Gardeners</option>
          <option value="cleaning_carpet">Cleaners & Carpet Cleaners</option>
          <option value="window_cleaning">Window Cleaners</option>
          <option value="pest_control">Pest Control</option>
          <option value="locksmith">Locksmith</option>
          <option value="gas_engineer">Gas Engineer</option>
          <option value="boiler_specialist">Boiler Specialist</option>
          <option value="bathroom_installer">Bathroom Installer</option>
          <option value="drainage">Drainage / Blockages</option>
          <option value="heat_pump">Heat Pump / Renewables</option>
        </select>

        <label>WhatsApp number</label>
        <input id="whatsapp_number" />
        <button class="btn" onclick="saveBusiness()">Save business details</button>
      </div>

      <!-- PRICING -->
      <div class="card">
        <h2>Pricing guidance</h2>
        <label>Call-out fee (£)</label>
        <input id="callout_fee" type="number" />
        <label>Hourly rate (£)</label>
        <input id="hourly_rate" type="number" />
        <label>Minimum job price (£)</label>
        <input id="minimum_job_price" type="number" />
        <label>Pricing explanation</label>
        <textarea id="pricing_notes"></textarea>
        <button class="btn" onclick="savePricing()">Save pricing & AI settings</button>
      </div>

      <!-- AI -->
      <div class="card">
        <h2>Assistant behaviour</h2>
        <label>Tone of voice</label>
        <textarea id="ai_tone"></textarea>
        <label>Rules / things to avoid</label>
        <textarea id="ai_rules"></textarea>
      </div>

    </div>
  </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
/* ===== CONFIG – EDIT THESE ONLY ===== */
const SUPABASE_URL = "https://yaiutswdcbfwkxfqxkzy.supabase.co";
const SUPABASE_ANON = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlhaXV0c3dkY2Jmd2t4ZnF4a3p5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ1MDE2MDgsImV4cCI6MjA4MDA3NzYwOH0.HOLFxzjsZ5Ieqg0b-aTdP0hAdLsPVXL6Zjs-HgOHgc8";
const BUSINESS_ID   = "2572fb3a-f82f-4d58-be9b-bf7ee4933143";
/* =================================== */

const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON);

const el = id => document.getElementById(id);

// LOAD
async function loadBusiness() {
  const { data, error } = await sb
    .from("business_profiles")
    .select("*")
    .eq("id", BUSINESS_ID)
    .single();

  if (error) return alert("Load failed");

  el("business_name").value = data.business_name || "";
  el("trade_type").value = data.trade_type || "";
  el("whatsapp_number").value = data.whatsapp_number || "";
  el("callout_fee").value = data.callout_fee || "";
  el("hourly_rate").value = data.hourly_rate || "";
  el("minimum_job_price").value = data.minimum_job_price || "";
  el("pricing_notes").value = data.pricing_notes || "";
  el("ai_tone").value = data.ai_tone || "";
  el("ai_rules").value = data.ai_rules || "";
}

// SAVE
async function saveBusiness() {
  await sb.from("business_profiles").update({
    business_name: el("business_name").value,
    trade_type: el("trade_type").value,
    whatsapp_number: el("whatsapp_number").value
  }).eq("id", BUSINESS_ID);
  alert("Business details saved ✅");
}

async function savePricing() {
  await sb.from("business_profiles").update({
    callout_fee: el("callout_fee").value,
    hourly_rate: el("hourly_rate").value,
    minimum_job_price: el("minimum_job_price").value,
    pricing_notes: el("pricing_notes").value,
    ai_tone: el("ai_tone").value,
    ai_rules: el("ai_rules").value
  }).eq("id", BUSINESS_ID);
  alert("Pricing & AI saved ✅");
}

loadBusiness();
</script>
</body>
</html>
