<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TradeBotPro — Your AI Office Profile</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta
    name="description"
    content="Update your TradeBotPro AI office profile so enquiries, pricing and messages are set up correctly for your business."
  />
  <style>
    :root {
      --primary-blue: #1f4e79;
      --accent-blue: #00a3ff;
      --dark-text: #1b1b1f;
      --light-bg: #f5f7fa;
      --white: #ffffff;
      --danger: #b3261e;
      --success: #146c2e;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      background: var(--light-bg);
      color: var(--dark-text);
      line-height: 1.6;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    .page {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      background: #ffffff;
      border-bottom: 1px solid rgba(0,0,0,0.05);
      padding: 0.8rem 1.25rem;
    }

    .header-inner {
      max-width: 960px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
    }

    .logo-wrap {
      display: flex;
      align-items: center;
      gap: 0.6rem;
    }

    .logo-icon {
      width: 28px;
      height: 28px;
      border-radius: 9px;
      background: var(--primary-blue);
      position: relative;
    }

    .logo-icon::before,
    .logo-icon::after {
      content: "";
      position: absolute;
      background: var(--white);
      border-radius: 3px;
    }

    .logo-icon::before {
      width: 10px;
      height: 15px;
      left: 6px;
      top: 6px;
    }

    .logo-icon::after {
      width: 5px;
      height: 10px;
      right: 6px;
      top: 9px;
    }

    .logo-main {
      font-weight: 700;
      color: var(--primary-blue);
      font-size: 1rem;
    }

    .logo-tag {
      font-size: 0.72rem;
      opacity: 0.7;
    }

    main {
      flex: 1;
      padding: 2.5rem 1.25rem 3rem;
    }

    .inner {
      max-width: 960px;
      margin: 0 auto;
    }

    h1 {
      margin: 0 0 0.4rem;
      font-size: 1.7rem;
      color: var(--primary-blue);
    }

    .lead {
      margin: 0 0 1.4rem;
      font-size: 0.98rem;
      max-width: 40rem;
    }

    .card {
      background: #ffffff;
      border-radius: 1rem;
      padding: 1.4rem 1.5rem 1.6rem;
      box-shadow: 0 10px 26px rgba(0,0,0,0.05);
      font-size: 0.9rem;
    }

    .small {
      font-size: 0.8rem;
      opacity: 0.8;
    }

    .status {
      margin-bottom: 1rem;
      padding: 0.55rem 0.7rem;
      border-radius: 0.5rem;
      font-size: 0.85rem;
      display: none;
    }

    .status--error {
      display: block;
      background: #fbeaea;
      color: var(--danger);
      border: 1px solid rgba(179,38,30,0.3);
    }

    .status--success {
      display: block;
      background: #e7f3ea;
      color: var(--success);
      border: 1px solid rgba(20,108,46,0.3);
    }

    .status--info {
      display: block;
      background: #e7f0fb;
      color: #1f4e79;
      border: 1px solid rgba(31,78,121,0.35);
    }

    .two-col {
      display: grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap: 0.9rem 1.2rem;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 0.2rem;
    }

    .field label {
      font-size: 0.78rem;
      font-weight: 500;
    }

    .field span.hint {
      font-size: 0.75rem;
      opacity: 0.75;
    }

    input, select, textarea {
      border-radius: 0.5rem;
      border: 1px solid rgba(0,0,0,0.16);
      padding: 0.5rem 0.6rem;
      font: inherit;
      width: 100%;
    }

    textarea {
      min-height: 90px;
      resize: vertical;
    }

    input:focus, select:focus, textarea:focus {
      outline: 2px solid rgba(31,78,121,0.45);
      border-color: transparent;
    }

    .field--full {
      grid-column: 1 / -1;
    }

    .actions {
      margin-top: 1.2rem;
      display: flex;
      gap: 0.7rem;
      align-items: center;
      flex-wrap: wrap;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 0.7rem 1.4rem;
      cursor: pointer;
      font: inherit;
    }

    .btn-primary {
      background: var(--primary-blue);
      color: #ffffff;
      font-weight: 600;
    }

    .btn-primary:hover {
      background: #163857;
    }

    .btn-outline {
      background: #ffffff;
      border: 1px solid rgba(0,0,0,0.18);
      color: var(--primary-blue);
      font-size: 0.85rem;
    }

    .muted {
      font-size: 0.8rem;
      opacity: 0.75;
    }

    @media (max-width: 720px) {
      main { padding-top: 2rem; }
      .two-col {
        grid-template-columns: minmax(0,1fr);
      }
    }
  </style>
</head>
<body>
<div class="page">
  <header>
    <div class="header-inner">
      <div class="logo-wrap">
        <div class="logo-icon" aria-hidden="true"></div>
        <div>
          <div class="logo-main">TradeBotPro</div>
          <div class="logo-tag">AI office assistant for trades</div>
        </div>
      </div>
      <div class="small">
        Business profile portal
      </div>
    </div>
  </header>

  <main>
    <div class="inner">
      <h1>Your AI Office Profile</h1>
      <p class="lead">
        This page lets you update the key details TradeBotPro uses when handling your enquiries
        — contact details, pricing and how you like to work.
      </p>

      <div id="status" class="status"></div>

      <div class="card">
        <form id="profile-form">
          <div class="two-col">
            <div class="field">
              <label for="business_name">Business name</label>
              <input id="business_name" name="business_name" type="text" autocomplete="organization" />
            </div>

            <div class="field">
              <label for="contact_name">Main contact name</label>
              <input id="contact_name" name="contact_name" type="text" autocomplete="name" />
            </div>

            <div class="field">
              <label for="email">Email</label>
              <input id="email" name="email" type="email" autocomplete="email" />
            </div>

            <div class="field">
              <label for="whatsapp_number">Mobile / WhatsApp number</label>
              <span class="hint">This is the main number TradeBotPro will use.</span>
              <input id="whatsapp_number" name="whatsapp_number" type="tel" />
            </div>

            <div class="field">
              <label for="phone">Optional landline</label>
              <span class="hint">Shown on messages and quotes if you want.</span>
              <input id="phone" name="phone" type="tel" />
            </div>

            <div class="field">
              <label for="trade_type">Trade</label>
              <select id="trade_type" name="trade_type">
                <option value="">Select your trade…</option>
                <option>Plumber</option>
                <option>Heating Engineer</option>
                <option>Gas Engineer</option>
                <option>Electrician</option>
                <option>Builder</option>
                <option>Handyman</option>
                <option>Landscaper / Gardener</option>
                <option>Cleaner / Carpet Cleaner</option>
                <option>Pest Control</option>
                <option>Other</option>
              </select>
            </div>

            <div class="field">
              <label for="base_postcode">Base postcode</label>
              <input id="base_postcode" name="base_postcode" type="text" />
            </div>

            <div class="field">
              <label for="service_radius">Service radius (miles)</label>
              <input id="service_radius" name="service_radius" type="number" min="0" step="1" />
            </div>

            <div class="field field--full">
              <label for="website_url">Website (optional)</label>
              <input id="website_url" name="website_url" type="url" placeholder="https://…" />
            </div>

            <div class="field">
              <label for="callout_fee">Call-out fee (£)</label>
              <input id="callout_fee" name="callout_fee" type="number" min="0" step="1" />
            </div>

            <div class="field">
              <label for="first_hour_rate">First hour rate (£)</label>
              <input id="first_hour_rate" name="first_hour_rate" type="number" min="0" step="1" />
            </div>

            <div class="field">
              <label for="hourly_rate">Hourly rate after first hour (£)</label>
              <input id="hourly_rate" name="hourly_rate" type="number" min="0" step="1" />
            </div>

            <div class="field">
              <label for="boiler_service_from">Boiler service from (£)</label>
              <input id="boiler_service_from" name="boiler_service_from" type="number" min="0" step="1" />
            </div>

            <div class="field">
              <label for="quote_minimum">Minimum job / quote value (£)</label>
              <input id="quote_minimum" name="quote_minimum" type="number" min="0" step="1" />
            </div>

            <div class="field field--full">
              <label for="services_summary">What services do you offer?</label>
              <span class="hint">Short bullets are fine — e.g. boiler installs, repairs, landlord certs.</span>
              <textarea id="services_summary" name="services_summary"></textarea>
            </div>

            <div class="field field--full">
              <label for="ai_style_notes">How should your AI office speak to customers?</label>
              <span class="hint">
                E.g. “Friendly but professional, no jargon, don’t give fixed prices without photos, 
                always check parking / access.”
              </span>
              <textarea id="ai_style_notes" name="ai_style_notes"></textarea>
            </div>
          </div>

          <div class="actions">
            <button type="submit" class="btn-primary">Save changes</button>
            <button type="button" id="reset-btn" class="btn-outline">Reset back to last saved</button>
            <span class="muted" id="last-saved"></span>
          </div>
        </form>
      </div>
    </div>
  </main>
</div>

<script>
  // CONFIG FIRST
  const supabaseUrl = 'https://yaiutswdcbfwkxfqxkzy.supabase.co';
  const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...';

  // helpers
  function getUserIdFromUrl() { ... }

  // fetchProfile()
  async function fetchProfile(userId) { ... }

  // saveProfile()
  async function saveProfile(userId, payload) { ... }

  // initialise()
  async function initialise() { ... }

  initialise();
</script>

</body>
</html>
