<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TradeBotPro — Get your AI office set up</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root {
  --blue: #1f4e79;
  --blue-soft: #e6eef6;
  --text: #1b1b1f;
  --muted: #6b7280;
  --border: #d1d5db;
  --bg: #f5f7fa;
}

* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
}

.container {
  max-width: 980px;
  margin: 40px auto;
  padding: 0 16px;
}

.card {
  background: #fff;
  border-radius: 18px;
  box-shadow: 0 20px 60px rgba(0,0,0,.12);
  padding: 36px;
}

h1 {
  margin: 0 0 8px;
  color: var(--blue);
}

.subtitle {
  color: var(--muted);
  margin-bottom: 28px;
  font-size: 15px;
}

.progress {
  margin-bottom: 28px;
}

.progress-top {
  display: flex;
  justify-content: space-between;
  font-size: 13px;
  color: var(--muted);
  margin-bottom: 6px;
}

.progress-track {
  height: 6px;
  background: #e5e7eb;
  border-radius: 999px;
  overflow: hidden;
}

.progress-bar {
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg,var(--blue),#00a3ff);
  transition: width .3s;
}

.step {
  display: none;
}

.step.active {
  display: block;
}

.step h2 {
  margin-top: 0;
  font-size: 18px;
  color: var(--blue);
}

.row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}

.field {
  margin-bottom: 16px;
}

label {
  display: block;
  font-weight: 600;
  font-size: 14px;
  margin-bottom: 4px;
}

.hint {
  font-size: 12px;
  color: var(--muted);
  margin-bottom: 6px;
}

input, textarea, select {
  width: 100%;
  padding: 10px 12px;
  font-size: 14px;
  border: 1px solid var(--border);
  border-radius: 10px;
}

textarea {
  min-height: 70px;
  resize: vertical;
}

select {
  background: #fff;
}

.chips {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 6px;
}

.chip {
  padding: 6px 12px;
  border-radius: 999px;
  border: 1px solid var(--blue);
  background: var(--blue-soft);
  color: var(--blue);
  font-size: 13px;
  cursor: pointer;
}

.chip.selected {
  background: var(--blue);
  color: #fff;
}

.footer {
  display: flex;
  justify-content: space-between;
  margin-top: 28px;
}

button {
  border: none;
  border-radius: 999px;
  padding: 10px 20px;
  font-size: 14px;
  cursor: pointer;
}

.btn-primary {
  background: var(--blue);
  color: #fff;
}

.btn-secondary {
  background: #e5e7eb;
}

.status {
  display: none;
  margin-top: 20px;
  padding: 12px;
  border-radius: 10px;
  font-size: 14px;
}

.success {
  background: #ecfdf3;
  color: #166534;
}

.error {
  background: #fef2f2;
  color: #991b1b;
}
</style>
</head>

<body>

<div class="container">
  <div class="card">
    <h1>Set up your TradeBotPro AI office</h1>
    <p class="subtitle">
      Answer a few quick questions and we’ll tailor TradeBotPro to your business.
    </p>

    <div class="progress">
      <div class="progress-top">
        <span>Step <strong id="stepNo">1</strong> of 4</span>
        <span id="stepLabel">Business details</span>
      </div>
      <div class="progress-track">
        <div class="progress-bar" id="progressBar"></div>
      </div>
    </div>

    <form id="form">

      <!-- STEP 1 -->
      <div class="step active" data-step="1">
        <h2>Business details</h2>

        <div class="field">
          <label>Business name</label>
          <input id="business_name" required>
        </div>

        <div class="row">
          <div class="field">
            <label>Your name</label>
            <input id="owner_name" required>
          </div>
          <div class="field">
            <label>Email</label>
            <input id="email" type="email" required>
          </div>
        </div>

        <div class="footer">
          <span></span>
          <button type="button" class="btn-primary next">Next</button>
        </div>
      </div>

      <!-- STEP 2 -->
      <div class="step" data-step="2">
        <h2>Contact & pricing</h2>

        <div class="row">
          <div class="field">
            <label>WhatsApp number</label>
            <input id="phone" required>
            <div class="hint">Used for testing and customer enquiries</div>
          </div>
          <div class="field">
            <label>Base postcode</label>
            <input id="base_postcode">
          </div>
        </div>

        <div class="row">
          <div class="field">
            <label>Call-out fee (if any)</label>
            <input id="callout_fee">
          </div>
          <div class="field">
            <label>First hour rate</label>
            <input id="first_hour_rate">
          </div>
        </div>

        <div class="row">
          <div class="field">
            <label>Hourly rate after first hour</label>
            <input id="hourly_rate">
          </div>
          <div class="field">
            <label>Boiler service from</label>
            <input id="boiler_service_from">
          </div>
        </div>

        <div class="footer">
          <button type="button" class="btn-secondary back">Back</button>
          <button type="button" class="btn-primary next">Next</button>
        </div>
      </div>

      <!-- STEP 3 -->
      <div class="step" data-step="3">
        <h2>What should your AI office focus on?</h2>

        <div class="chips" id="focusChips">
          <div class="chip">Answering enquiries</div>
          <div class="chip">Booking jobs</div>
          <div class="chip">Following up quotes</div>
          <div class="chip">Diary management</div>
          <div class="chip">Out-of-hours cover</div>
          <div class="chip">Chasing unpaid invoices</div>
        </div>

        <div class="field" style="margin-top:16px;">
          <label>Anything specific?</label>
          <textarea id="ai_extra" placeholder="Optional – one sentence is plenty"></textarea>
        </div>

        <div class="footer">
          <button type="button" class="btn-secondary back">Back</button>
          <button type="button" class="btn-primary next">Next</button>
        </div>
      </div>

      <!-- STEP 4 -->
      <div class="step" data-step="4">
        <h2>Submit</h2>
        <p class="subtitle">We’ll review this and get in touch shortly.</p>

        <div class="footer">
          <button type="button" class="btn-secondary back">Back</button>
          <button type="submit" class="btn-primary">Submit</button>
        </div>

        <div class="status success" id="success">
          ✅ Thanks — we’ve received your details.
        </div>
        <div class="status error" id="error">
          ⚠️ Something went wrong. Please try again.
        </div>
      </div>

    </form>
  </div>
</div>

<script>
/* CONFIG */
const SUPABASE_URL = "https://yaiutswdcbfwkxfqxkzy.supabase.co";
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlhaXV0c3dkY2Jmd2t4ZnF4a3p5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ1MDE2MDgsImV4cCI6MjA4MDA3NzYwOH0.HOLFxzjsZ5Ieqg0b-aTdP0hAdLsPVXL6Zjs-HgOHgc8";

/* STEPS */
let current = 1;
const steps = document.querySelectorAll('.step');
const bar = document.getElementById('progressBar');
const stepNo = document.getElementById('stepNo');
const stepLabel = document.getElementById('stepLabel');

const labels = {
  1:'Business details',
  2:'Contact & pricing',
  3:'AI focus',
  4:'Submit'
};

function show(step){
  current = step;
  steps.forEach(s=>s.classList.remove('active'));
  document.querySelector(`[data-step="${current}"]`).classList.add('active');
  bar.style.width = ((current-1)/3*100)+'%';
  stepNo.textContent = current;
  stepLabel.textContent = labels[current];
}

document.addEventListener('click',e=>{
  if(e.target.classList.contains('next')) show(current+1);
  if(e.target.classList.contains('back')) show(current-1);
});

/* CHIPS */
const chips = document.querySelectorAll('.chip');
chips.forEach(c=>c.onclick=()=>c.classList.toggle('selected'));

/* SUBMIT */
form.onsubmit = async e => {
  e.preventDefault();

  const focus = [...chips].filter(c=>c.classList.contains('selected')).map(c=>c.textContent);

  const payload = {
    business_name: business_name.value,
    owner_name: owner_name.value,
    email: email.value,
    phone: phone.value,
    base_postcode: base_postcode.value,
    callout_fee: callout_fee.value,
    first_hour_rate: first_hour_rate.value,
    hourly_rate: hourly_rate.value,
    boiler_service_from: boiler_service_from.value,
    services_summary: `Focus: ${focus.join(', ')} | ${ai_extra.value}`,
    plan_status: 'Lead - New',
    pending_setup: true,
    account_status: 'Lead - New',
    account_status_reason: 'Website signup'
  };

  try {
    const res = await fetch(
      `${SUPABASE_URL}/rest/v1/tradebotpro_signups`,
      {
        method:'POST',
        headers:{
          'Content-Type':'application/json',
          apikey:SUPABASE_ANON_KEY,
          Authorization:`Bearer ${SUPABASE_ANON_KEY}`
        },
        body: JSON.stringify(payload)
      }
    );

    if(!res.ok) throw new Error();
    success.style.display='block';
  } catch {
    error.style.display='block';
  }
};
</script>

</body>
</html>
